<html>
<head>
    <style>
        body {
            font-family: Roboto, sans-serif;
            font-size: 16px;
        }

        label {
            padding-top: 10px;
        }

        form {
            padding: 10px;
        }

        input {
            padding:5px;
            min-width: 200px;
        }

        button {
            margin-top: 10px;
            color: white;
            padding: 10px;
            background: green;
        }
        ul,li{
            list-style-type: none;
            margin: 0;
            padding:0;
        }
        .movie-group{
            margin: 10px;
            background: #eee;
            padding:20px;
            position: relative;
        }
        .movie-group__id {
            width:100%;
            padding: 0 0 10px;
        }
        .movie-group__delete {
            margin-right:4px;
            position: absolute;
            right:0;
            background-color: red;
            color:white;
            padding: 4px;
            margin-top: -15px;
            border-radius: 5px;
        }
        .movie {
            height: 100px;
            display: flex;
        }
        .movie span {
            margin-left: 10px;
        }

        .form__block{
            margin-top: 10px;
        }
    </style>
    <script src="assets/jquery_min.js"></script>
    <script src="assets/formvalidate_min.js"></script>
    <script>

      //const url = '173.212.239.184';
      const url = window.location.hostname;

      let getMovieMarkup = (movie,groupId) => {
        return `<li class="movie">
                    <a href="http://${url}:3000/images/${groupId}_${movie}.jpg"><img width="auto" height="100%" src="http://${url}:3000/images/${groupId}_${movie}.jpg"></a>
                    <span>${movie.split('_').join(' ')}</span>
                </li>`;
      };

      let createAvailableMoviesMarkup = (movieGroup) => {
        return `
        <li class="movie-group">
            <a class="movie-group__delete" href="http://${url}:3000/deleteMovie?id=${movieGroup.id}">X</a>
            <div class="movie-group__id"> ${movieGroup.id}</div>
            <ul>
            ${movieGroup.movies.map(movie => {return getMovieMarkup(movie,movieGroup.id)})}
            </ul>
        </li>
        `
      };

      let showCurrentMovies = () => {
          $.getJSON( "http://" + url + ":3000/movies", (movieGroups) => {
                let currentMovieContainer = document.getElementById('currentMovies');

                currentMovieContainer.innerHTML = `
                    ${movieGroups.map(createAvailableMoviesMarkup)}
                `;
          })
      };

      document.addEventListener("DOMContentLoaded", function() {
        $.validate({
          lang: 'de'
        });
        showCurrentMovies();
      });
    </script>
</head>
<body>
    <form ref='uploadForm'
          id='uploadForm'
          action='/upload'
          method='post'
          encType="multipart/form-data">

        <div class="form__block">
            <label for="file1_name">Film A: </label>
            <input data-validation="required" id="file1_name" type="text" name="file1_name"/>
            <input data-validation-max-size="2000kb" data-validation="required" type="file" name="file1"/>
        </div>

        <div class="form__block">
            <label for="file2_name">Film B: </label>
            <input id="file2_name" data-validation-depends-on="file2" type="text" name="file2_name"/>
            <input data-validation-max-size="2000kb"  type="file" name="file2"/>
        </div>

        <div class="form__block">
            <label for="file3_name">Film C: </label>
            <input data-validation-depends-on="file3" id="file3_name" type="text" name="file3_name"/>
            <input data-validation-max-size="2000kb"  type="file" name="file3"/>
        </div>
        <button type='submit'>Upload</button>
    </form>
    <a href="/game.html"><button>To the Game</button></a>
    <ul id="currentMovies">
    </ul>
</body>
</html>